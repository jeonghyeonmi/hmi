<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>ë¸Œë ˆì¸ ë¶„ì„ ë¦¬í¬íŠ¸ | SKZ Brain Lab</title>

    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        :root { 
            --primary-color: #1a3a5f; 
            --bg-color: #f4f7f9; 
            --accent-color: #d35400; 
            --text-main: #2c3e50;
            --text-muted: #7f8c8d;
            --focus-color: #047857; /* ì´ˆë¡: ì§‘ì¤‘/ì¸ì§€ */
            --logic-color: #1d4ed8; /* íŒŒë‘: ë…¼ë¦¬/ìˆ˜ë¦¬ */
            --speed-color: #be185d; /* ë¶„í™: ìˆœë°œ/ê¸°ì–µ */
        }
        * { box-sizing: border-box; -webkit-tap-highlight-color: transparent; }
        body { font-family: 'Pretendard', sans-serif; background: var(--bg-color); margin: 0; color: var(--text-main); line-height: 1.6; }

        header { background: var(--primary-color); color: white; padding: 1.2rem; text-align: center; }
        header h1 { margin: 0; font-size: 1.4rem; font-weight: 800; }
        header h1 a { text-decoration: none; color: inherit; }

        nav.main-nav { background: white; padding: 0.8rem; display: flex; justify-content: center; gap: 1.2rem; box-shadow: 0 2px 5px rgba(0,0,0,0.05); position: sticky; top: 0; z-index: 1000; }
        nav.main-nav a { text-decoration: none; color: var(--primary-color); font-weight: bold; font-size: 0.9rem; }
        nav.main-nav a.active { color: var(--accent-color); }

        .container { width: 95%; max-width: 500px; margin: 1.5rem auto; }
        .report-card { background: white; border-radius: 28px; padding: 30px 25px; box-shadow: 0 10px 30px rgba(0,0,0,0.05); text-align: center; position: relative; overflow: hidden; }
        .report-card::before { content: ''; position: absolute; top: 0; left: 0; width: 100%; height: 6px; background: linear-gradient(90deg, var(--primary-color), var(--accent-color)); }

        .type-name { font-size: 1.8rem; font-weight: 900; color: var(--primary-color); margin-bottom: 20px; letter-spacing: -0.05em; }
        .type-name mark { background: transparent; color: var(--accent-color); position: relative; }

        .chart-wrapper { position: relative; margin: 0 auto 20px; max-width: 320px; }

        /* [í•µì‹¬ ìˆ˜ì •] í´ë¦­ ê°€ëŠ¥í•œ ìŠ¤íƒœì¸  ìŠ¤íƒ€ì¼ */
        .stat-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 12px; margin-bottom: 20px; }
        .stat-item { 
            background: #f8fafc; padding: 15px 10px; border-radius: 18px; 
            text-align: center; border: 1px solid #f1f5f9; cursor: pointer;
            transition: all 0.2s ease;
        }
        .stat-item:hover { transform: translateY(-3px); border-color: var(--accent-color); box-shadow: 0 4px 12px rgba(0,0,0,0.05); }
        .stat-item:active { transform: scale(0.98); }
        .stat-label { font-size: 0.75rem; color: var(--text-muted); display: block; margin-bottom: 4px; }
        .stat-value { font-size: 1.1rem; font-weight: 800; color: var(--primary-color); }
        .stat-hint { font-size: 0.65rem; color: var(--accent-color); display: block; margin-top: 4px; font-weight: 600; }

        .description-box { background: #fff9f5; border-radius: 18px; padding: 20px; color: var(--text-main); font-size: 0.92rem; margin-bottom: 25px; border: 1px solid #ffedd5; text-align: left; }

        .action-buttons { display: flex; flex-direction: column; gap: 12px; }
        .btn { display: block; padding: 16px; border-radius: 30px; text-decoration: none; font-weight: 800; font-size: 1rem; transition: 0.3s; border: none; cursor: pointer; text-align: center;}
        .btn-retry { background: var(--primary-color); color: white; }
        .btn-share { background: #f1f5f9; color: #475569; }
        .btn-reset { background: transparent; color: #bbb; font-size: 0.75rem; padding: 5px; margin-top: 15px; text-decoration: underline; border: none; cursor: pointer; }

        footer { text-align: center; padding: 2.5rem 0; color: #bbb; font-size: 0.75rem; background: #fff; border-top: 1px solid #eee; margin-top: 2rem; }
    </style>
</head>
<body>

<header><h1><a href="/">SKZ ë‘ë‡Œ í›ˆë ¨ì†Œ</a></h1></header>

<nav class="main-nav">
    <a href="/">ë¸Œë ˆì¸ ë¶„ì„ì‹¤</a>
    <a href="dash.html">ë‘ë‡Œ í›ˆë ¨ì„¼í„°</a>
    <a href="report.html" class="active">ë‚˜ì˜ ë‘ë‡Œì ìˆ˜</a>
</nav>

<div class="container">
    <main class="report-card">
        <p class="user-type" style="font-size: 0.85rem; color: #7f8c8d; margin-bottom: 5px;">ë‹¹ì‹ ì˜ ë¸Œë ˆì¸ ë¶„ì„ ê²°ê³¼</p>
        <div class="type-name" id="brain-type">ë¶„ì„ ì¤‘...</div>
        
        <div class="chart-wrapper">
            <canvas id="abilityChart"></canvas>
        </div>

        <p style="font-size: 0.8rem; color: #94a3b8; margin-bottom: 10px;">ğŸ‘‡ ì˜ì—­ì„ í´ë¦­í•˜ë©´ ë§ì¶¤ í›ˆë ¨ìœ¼ë¡œ ì´ë™í•©ë‹ˆë‹¤</p>
        <div class="stat-grid" id="stat-summary">
            </div>

        <div class="description-box" id="type-desc"></div>

        <div class="action-buttons">
            <a href="dash.html" class="btn btn-retry">ì „ì²´ í›ˆë ¨ ëª©ë¡ ë³´ê¸°</a>
            <button onclick="shareResult()" class="btn btn-share">ğŸ“Š ê²°ê³¼ ì´ë¯¸ì§€ë¡œ ì €ì¥</button>
            <button class="btn-reset" onclick="resetData()">ëª¨ë“  í›ˆë ¨ ê¸°ë¡ ì´ˆê¸°í™”</button>
        </div>
    </main>
</div>

<footer>
    <div style="margin-bottom: 10px;">
        <a href="privacy.html">ê°œì¸ì •ë³´ì²˜ë¦¬ë°©ì¹¨</a> | <a href="terms.html">ì´ìš©ì•½ê´€</a>
    </div>
    &copy; 2026 SKZ Brain Lab. All rights reserved.
</footer>

<script>
    function getAverageScore(gameKeys) {
        let allScores = [];
        gameKeys.forEach(key => {
            const history = JSON.parse(localStorage.getItem(key + '_history')) || [];
            if (history.length > 0) {
                allScores = allScores.concat(history);
            } else {
                const singleScore = parseInt(localStorage.getItem(key + '_score'));
                if (!isNaN(singleScore) && singleScore > 0) allScores.push(singleScore);
            }
        });
        if (allScores.length === 0) return 0;
        const recentScores = allScores.slice(-10);
        return Math.floor(recentScores.reduce((a, b) => a + b, 0) / recentScores.length);
    }

    const scores = {
        focus: getAverageScore(['game1', 'game8']),
        logic: getAverageScore(['game2', 'game7']),
        speed: getAverageScore(['game3']),
        memory: getAverageScore(['game4']),
        math: getAverageScore(['game5']),
        cognition: getAverageScore(['game6'])
    };

    // ëŠ¥ë ¥ì¹˜ë³„ ì´ë™í•  í˜ì´ì§€ ë§¤í•‘
    function getGameLink(key) {
        const links = {
            focus: 'game.html',      // ì •ë°€ ì§‘ì¤‘ (ë©”ëª¨ë¦¬ê²Œì„)
            logic: 'game2.html',     // ì „ëµ ë…¼ë¦¬ (ì¹´ë“œë§¤ì¹­)
            speed: 'game3.html',     // ì¾Œì† íŒë‹¨ (ì¢Œìš°í„°ì¹˜)
            memory: 'game4.html',    // ê¸°ì–µë ¥ (ìœ„ì¹˜ê¸°ì–µ)
            math: 'game5.html',      // ìˆ˜ë¦¬ë ¥ (ì‚°ìˆ˜)
            cognition: 'game6.html'  // ì¸ì§€ë ¥ (ìƒ‰ìƒì¼ì¹˜)
        };
        return links[key] || 'dash.html';
    }

    function getAbilityName(key) {
        const names = { focus:'ì§‘ì¤‘ë ¥', logic:'ë…¼ë¦¬ë ¥', speed:'ìˆœë°œë ¥', memory:'ê¸°ì–µë ¥', math:'ìˆ˜ë¦¬ë ¥', cognition:'ì¸ì§€ë ¥' };
        return names[key];
    }

    // ì°¨íŠ¸ ìƒì„±
    const ctx = document.getElementById('abilityChart').getContext('2d');
    new Chart(ctx, {
        type: 'radar',
        data: {
            labels: ['ì§‘ì¤‘ë ¥', 'ë…¼ë¦¬ë ¥', 'ìˆœë°œë ¥', 'ê¸°ì–µë ¥', 'ìˆ˜ë¦¬ë ¥', 'ì¸ì§€ë ¥'],
            datasets: [{
                data: [scores.focus, scores.logic, scores.speed, scores.memory, scores.math, scores.cognition],
                backgroundColor: 'rgba(211, 84, 0, 0.1)',
                borderColor: 'rgba(211, 84, 0, 1)',
                borderWidth: 2,
                pointRadius: 4,
                pointBackgroundColor: 'rgba(211, 84, 0, 1)'
            }]
        },
        options: {
            scales: {
                r: { suggestedMin: 0, suggestedMax: 100, ticks: { display: false, stepSize: 25 }, pointLabels: { font: { size: 12, weight: '700' } } }
            },
            plugins: { legend: { display: false } }
        }
    });

    function updateUI() {
        const totalScore = Object.values(scores).reduce((a, b) => a + b, 0);
        const avgScore = Math.floor(totalScore / 6);
        const brainTypeElem = document.getElementById('brain-type');
        const descElem = document.getElementById('type-desc');

        // 1. ë¸Œë ˆì¸ íƒ€ì… ê²°ì •
        if (totalScore === 0) {
            brainTypeElem.innerHTML = "ìƒˆë‚´ê¸° <mark>í›ˆë ¨ì‚¬</mark>";
            descElem.innerText = "ì•„ì§ ë¶„ì„í•  ë°ì´í„°ê°€ ë¶€ì¡±í•©ë‹ˆë‹¤. ë‘ë‡Œ í›ˆë ¨ì„¼í„°ì—ì„œ ê²Œì„ì„ í”Œë ˆì´í•˜ì‹œë©´ ì •ë°€ ë¦¬í¬íŠ¸ê°€ ìƒì„±ë©ë‹ˆë‹¤!";
        } else {
            const maxVal = Math.max(...Object.values(scores));
            const bestAbility = Object.keys(scores).find(key => scores[key] === maxVal);
            
            let typeName = "";
            let description = "";

            if(bestAbility === 'math') { typeName = "ëƒ‰ì² í•œ <mark>ìˆ˜í•™ì</mark>"; description = "ìˆ«ìì˜ ì§ˆì„œ ì†ì—ì„œ ì •ë‹µì„ ë¹ ë¥´ê²Œ ë„ì¶œí•˜ëŠ” ìˆ˜ë¦¬ì  ì§ê´€ì´ ë§¤ìš° ë°œë‹¬í•´ ìˆìŠµë‹ˆë‹¤."; }
            else if(bestAbility === 'speed' || bestAbility === 'cognition') { typeName = "ë‚ ë µí•œ <mark>ì¹˜íƒ€</mark>"; description = "ìƒí™©ì„ íŒë‹¨í•˜ê³  ë°˜ì‘í•˜ëŠ” ì†ë„ê°€ ë‚¨ë‹¤ë¦…ë‹ˆë‹¤. ì¸ì§€ ìœ ì—°ì„±ì´ ë‹¹ì‹ ì˜ ê°€ì¥ í° ë¬´ê¸°ì…ë‹ˆë‹¤."; }
            else if(bestAbility === 'memory') { typeName = "ê¸°ë¡í•˜ëŠ” <mark>í˜„ì</mark>"; description = "í•œ ë²ˆ ë³¸ ì •ë³´ë¥¼ ë†“ì¹˜ì§€ ì•ŠëŠ” ì •êµí•œ ê¸°ì–µ ë©”ì»¤ë‹ˆì¦˜ì„ ê°€ì¡ŒìŠµë‹ˆë‹¤."; }
            else if(bestAbility === 'focus') { typeName = "ëª°ì…í•˜ëŠ” <mark>ì¥ì¸</mark>"; description = "ì£¼ë³€ì˜ ì†ŒìŒì„ ì°¨ë‹¨í•˜ê³  ëª©í‘œì—ë§Œ ì—ë„ˆì§€ë¥¼ ìŸì•„ë¶“ëŠ” ë†€ë¼ìš´ ì§‘ì¤‘ë ¥ì„ ë³´ìœ í•˜ê³  ê³„ì‹­ë‹ˆë‹¤."; }
            else if(bestAbility === 'logic') { typeName = "ì¹˜ë°€í•œ <mark>ì „ëµê°€</mark>"; description = "ë…¼ë¦¬ì  ì¸ê³¼ê´€ê³„ë¥¼ íŒŒì•…í•˜ê³  ìµœì„ ì˜ ìˆ˜ë¥¼ ì°¾ì•„ë‚´ëŠ” ëŠ¥ë ¥ì´ íƒì›”í•©ë‹ˆë‹¤."; }
            
            brainTypeElem.innerHTML = typeName;
            descElem.innerText = description;
        }

        // 2. ëŠ¥ë ¥ì¹˜ ê·¸ë¦¬ë“œ ìƒì„± (í´ë¦­ ê¸°ëŠ¥ í¬í•¨)
        const summaryGrid = document.getElementById('stat-summary');
        summaryGrid.innerHTML = ''; // ì´ˆê¸°í™”

        // ì¢…í•© ì ìˆ˜ ë¨¼ì € ì¶”ê°€
        const avgItem = document.createElement('div');
        avgItem.className = 'stat-item';
        avgItem.style.gridColumn = 'span 2';
        avgItem.innerHTML = `<span class="stat-label">ì¢…í•© í‰ê·  ì ìˆ˜</span><span class="stat-value">${avgScore}ì </span>`;
        summaryGrid.appendChild(avgItem);

        // ê°œë³„ ëŠ¥ë ¥ì¹˜ ì¶”ê°€
        Object.keys(scores).forEach(key => {
            const item = document.createElement('div');
            item.className = 'stat-item';
            item.onclick = () => { location.href = getGameLink(key); };
            item.innerHTML = `
                <span class="stat-label">${getAbilityName(key)}</span>
                <span class="stat-value">${scores[key]}ì </span>
                <span class="stat-hint">í›ˆë ¨í•˜ê¸° ></span>
            `;
            summaryGrid.appendChild(item);
        });
    }

    function resetData() { 
        if(confirm("ëª¨ë“  í›ˆë ¨ ê¸°ë¡ê³¼ ë¦¬í¬íŠ¸ê°€ ì´ˆê¸°í™”ë©ë‹ˆë‹¤. ì •ë§ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?")) { 
            localStorage.clear(); 
            location.reload(); 
        } 
    }
    
    function shareResult() { alert("ê¸°ê¸°ì˜ 'ìŠ¤í¬ë¦°ìƒ· ìº¡ì²˜' ê¸°ëŠ¥ì„ ì´ìš©í•´ ë¶„ì„ ê²°ê³¼ë¥¼ ì €ì¥í•´ ì£¼ì„¸ìš”!"); }

    updateUI();
</script>
</body>
</html>
