<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>ë…¼ë¦¬ë ¥ í›ˆë ¨: AI ì˜¤ëª© ëŒ€ê²° | SKZ Brain Lab</title>

    <meta name="description" content="AIë¥¼ ìƒëŒ€ë¡œ ë‹¹ì‹ ì˜ ìˆ˜ ì½ê¸° ëŠ¥ë ¥ì„ ì¦ëª…í•˜ì„¸ìš”. 3x3 ê¸ˆìˆ˜ ê·œì¹™ì´ ì ìš©ëœ ì •í†µ ì˜¤ëª© í›ˆë ¨ìœ¼ë¡œ ë…¼ë¦¬ì  ì‚¬ê³ ë ¥ì„ ê·¹ëŒ€í™”í•©ë‹ˆë‹¤.">
    <meta name="keywords" content="ë…¼ë¦¬ë ¥í›ˆë ¨, ì˜¤ëª©ê²Œì„, AIì˜¤ëª©, ë‘ë‡Œê²Œì„, ìˆ˜ì½ê¸°, ë‡Œê³¼í•™, SKZBrainLab">
    
    <meta property="og:title" content="AIë¥¼ ì´ê¸¸ ìˆ˜ ìˆì„ê¹Œìš”? - SKZ ì˜¤ëª© ìˆ˜ ì½ê¸°">
    <meta property="og:description" content="ë‹¨ìˆœí•œ ê²Œì„ì´ ì•„ë‹™ë‹ˆë‹¤. 5ìˆ˜ë¥¼ ì•ì„œê°€ëŠ” AIë¥¼ ìƒëŒ€ë¡œ ë‹¹ì‹ ì˜ ë…¼ë¦¬ë ¥ì„ í…ŒìŠ¤íŠ¸í•˜ì„¸ìš”.">
    <meta property="og:image" content="img/index.jpg"> 
    <meta property="og:url" content="https://jeonghyeonmi.github.io/hmi/game2.html">

    <style>
        :root { --primary-color: #1a3a5f; --bg-color: #f4f7f9; --accent-color: #3498db; --board-color: #edc9af; }
        * { box-sizing: border-box; -webkit-tap-highlight-color: transparent; }
        body { font-family: 'Pretendard', sans-serif; background-color: var(--bg-color); margin: 0; color: #333; }
        
        /* í—¤ë”/ë„¤ë¹„ê²Œì´ì…˜ (game3ì™€ ë™ì¼) */
        header { background: var(--primary-color); color: white; padding: 1.2rem; text-align: center; }
        header h1 { margin: 0; font-size: 1.4rem; font-weight: 800; }
        header h1 a { text-decoration: none; color: inherit; }
        nav.main-nav { 
            background: white; padding: 0.8rem; display: flex; justify-content: center; gap: 1.2rem; 
            box-shadow: 0 2px 5px rgba(0,0,0,0.05); overflow-x: auto; white-space: nowrap; 
            scrollbar-width: none; position: sticky; top: 0; z-index: 1000;
        }
        nav.main-nav::-webkit-scrollbar { display: none; }
        nav.main-nav a { text-decoration: none; color: var(--primary-color); font-weight: bold; font-size: 0.9rem; flex-shrink: 0; }
        nav.main-nav a.active { color: var(--accent-color); border-bottom: 2px solid var(--accent-color); }

        /* ğŸ® ì„œë¸Œ ê²Œì„ ë„¤ë¹„ê²Œì´ì…˜ (game2ë§Œì˜ ì„œë¸Œë©”ë‰´) */
        .sub-nav { display: flex; justify-content: center; gap: 12px; padding: 12px 0; background: #fff; border-bottom: 1px solid #eee; font-size: 0.75rem; }
        .sub-nav a { text-decoration: none; color: #aaa; font-weight: 500; }
        .sub-nav a.current { color: var(--accent-color); font-weight: bold; }

        .container { 
            width: 95%; max-width: 500px; margin: 1.5rem auto; padding: 20px; 
            background: white; border-radius: 24px; box-shadow: 0 10px 30px rgba(0,0,0,0.05); text-align: center; 
        }

        .game-guide { 
            background: #eef7ff; border-radius: 12px; padding: 15px; font-size: 0.85rem; 
            line-height: 1.6; color: #444; margin-bottom: 20px; text-align: left; border-left: 4px solid var(--accent-color); 
        }
        .game-guide strong { color: var(--accent-color); display: block; margin-bottom: 4px; }
        
        .status-box { display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px; font-weight: bold; font-size: 1rem; }
        
        /* ì˜¤ëª©íŒ ëª¨ë°”ì¼ ìµœì í™” */
        #canvas-wrapper { 
            width: 100%; aspect-ratio: 1 / 1; background: var(--board-color); 
            border-radius: 12px; box-shadow: inset 0 0 10px rgba(0,0,0,0.1);
            position: relative; touch-action: none; overflow: hidden;
        }
        canvas { width: 100%; height: 100%; display: block; }
        
        #msg-overlay { color: #e74c3c; font-size: 0.85rem; margin-top: 8px; height: 1.2rem; font-weight: bold; }

        .btn-undo { 
            padding: 8px 16px; background: white; border: 1.5px solid #ddd; border-radius: 8px;
            font-size: 0.85rem; cursor: pointer; color: #666; font-weight: bold;
        }

        .btn-reset { width: 100%; max-width: 280px; padding: 16px; background: var(--primary-color); color: white; border: none; border-radius: 30px; font-weight: bold; font-size: 1rem; margin-top: 20px; cursor: pointer; }

        /* í•˜ë‹¨ ê¸°ë¡ ì„¹ì…˜ */
        .ranking-container { margin-top: 35px; border-top: 2px dashed #eee; padding-top: 25px; }
        .rank-table { width: 100%; border-collapse: collapse; font-size: 0.85rem; }
        .rank-table th { padding: 10px; color: #888; border-bottom: 1px solid #eee; }
        .rank-table td { padding: 12px 5px; border-bottom: 1px solid #f9f9f9; }

        footer { text-align: center; padding: 3rem 0; color: #bbb; font-size: 0.8rem; }
    </style>
</head>
<body>
    <header>
        <h1><a href="index.html">SKZ ë‘ë‡Œ í›ˆë ¨ì†Œ</a></h1>
    </header>

    <nav class="main-nav">
        <a href="index.html">í™ˆ</a>
        <a href="game.html">ì§‘ì¤‘ë ¥</a>
        <a href="game2.html" class="active">ë…¼ë¦¬ë ¥</a>
        <a href="game3.html">íŒë‹¨ë ¥</a>
        <a href="report.html">ë¦¬í¬íŠ¸</a>
        <a href="posts.html">ë¶„ì„ì‹¤</a>
    </nav>

    <div class="sub-nav">
        <a href="game2_sudoku.html">[ë¯¸ë‹ˆìŠ¤ë„ì¿ ]</a>
        <a href="game2.html" class="current">[AI ì˜¤ëª©]</a>
    </div>

    <main class="container">
        <div class="game-guide">
            <strong>ğŸ“ ë…¼ë¦¬ë ¥ í›ˆë ¨ ê·œì¹™</strong>
            ìƒëŒ€(AI)ë³´ë‹¤ ë¨¼ì € 5ê°œì˜ ëŒì„ ì´ìœ¼ì„¸ìš”. <br>
            â€» í‘ëŒ(ì‚¬ìš©ì)ì€ <b>3x3 ê¸ˆìˆ˜ ê·œì¹™</b>ì´ ì ìš©ë©ë‹ˆë‹¤.
        </div>
        
        <div class="status-box">
            <span id="turn-display">ì°¨ë¡€: í‘ëŒ â—</span>
            <button class="btn-undo" onclick="undo()">í•œ ìˆ˜ ë¬´ë¥´ê¸°</button>
        </div>

        <div id="canvas-wrapper">
            <canvas id="omokCanvas"></canvas>
        </div>
        <div id="msg-overlay"></div>

        <button class="btn-reset" onclick="resetGame()">ê²Œì„ ì´ˆê¸°í™”</button>

        <div class="ranking-container">
            <div style="font-weight:bold; margin-bottom:15px; color:var(--primary-color);">ğŸ“Š ì˜¤ëª© ì „ì  ê¸°ë¡</div>
            <table class="rank-table">
                <thead><tr><th>íšŒì°¨</th><th>ê²°ê³¼</th><th>ë‚ ì§œ</th></tr></thead>
                <tbody id="historyBody"></tbody>
            </table>
        </div>
    </main>

    <footer>
        &copy; 2026 SKZ Brain Lab. All rights reserved.
    </footer>

    <script>
        const canvas = document.getElementById('omokCanvas');
        const ctx = canvas.getContext('2d');
        const turnDisplay = document.getElementById('turn-display');
        const msgOverlay = document.getElementById('msg-overlay');
        
        const boardSize = 15;
        let cellSize;
        let board = Array.from(Array(boardSize), () => Array(boardSize).fill(0));
        let moveHistory = [];
        let gameOver = false;

        function initCanvas() {
            const dpr = window.devicePixelRatio || 1;
            const rect = canvas.getBoundingClientRect();
            canvas.width = rect.width * dpr;
            canvas.height = rect.width * dpr;
            ctx.scale(dpr, dpr);
            cellSize = rect.width / boardSize;
            drawBoard();
        }

        function drawBoard() {
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            ctx.strokeStyle = "#444";
            ctx.lineWidth = 0.5;
            for (let i = 0; i < boardSize; i++) {
                ctx.beginPath();
                ctx.moveTo(cellSize/2, cellSize/2 + i*cellSize);
                ctx.lineTo(canvas.width/devicePixelRatio - cellSize/2, cellSize/2 + i*cellSize);
                ctx.stroke();
                ctx.beginPath();
                ctx.moveTo(cellSize/2 + i*cellSize, cellSize/2);
                ctx.lineTo(cellSize/2 + i*cellSize, canvas.width/devicePixelRatio - cellSize/2);
                ctx.stroke();
            }
            board.forEach((row, y) => row.forEach((val, x) => {
                if(val !== 0) drawStone(x, y, val);
            }));
        }

        function drawStone(x, y, player) {
            ctx.beginPath();
            ctx.arc(cellSize/2 + x*cellSize, cellSize/2 + y*cellSize, cellSize/2 - 4, 0, Math.PI * 2);
            ctx.fillStyle = player === 1 ? "#000" : "#fff";
            ctx.fill();
            if(player === 2) { ctx.strokeStyle = "#ccc"; ctx.stroke(); }
            
            // ë§ˆì§€ë§‰ ìˆ˜ í‘œì‹œ
            if(moveHistory.length > 0) {
                const last = moveHistory[moveHistory.length-1];
                if(last.x === x && last.y === y) {
                    ctx.beginPath();
                    ctx.arc(cellSize/2 + x*cellSize, cellSize/2 + y*cellSize, 3, 0, Math.PI * 2);
                    ctx.fillStyle = player === 1 ? "#fff" : "#000";
                    ctx.fill();
                }
            }
        }

        // 33 ê¸ˆìˆ˜ ë¡œì§
        function isDoubleThree(x, y, player) {
            if (player !== 1) return false;
            let count3 = 0;
            const directions = [[1,0], [0,1], [1,1], [1,-1]];
            board[y][x] = player;
            for (let [dx, dy] of directions) {
                if (isOpenThree(x, y, dx, dy, player)) count3++;
            }
            board[y][x] = 0;
            return count3 >= 2;
        }

        function isOpenThree(x, y, dx, dy, player) {
            let count = 1, openEnds = 0;
            [[dx, dy], [-dx, -dy]].forEach(([sx, sy]) => {
                let space = false;
                for (let i = 1; i <= 4; i++) {
                    let nx = x + sx*i, ny = y + sy*i;
                    if (nx<0||nx>=boardSize||ny<0||ny>=boardSize) break;
                    if (board[ny][nx] === player) { if(!space) count++; else break; }
                    else if (board[ny][nx] === 0) { openEnds++; space = true; break; }
                    else break;
                }
            });
            return count === 3 && openEnds === 2;
        }

        function checkWin(x, y, player) {
            const directions = [[1,0], [0,1], [1,1], [1,-1]];
            for (let [dx, dy] of directions) {
                let count = 1;
                [[dx, dy], [-dx, -dy]].forEach(([sx, sy]) => {
                    for (let i = 1; i < 5; i++) {
                        let nx = x + sx*i, ny = y + sy*i;
                        if (nx >= 0 && nx < boardSize && ny >= 0 && ny < boardSize && board[ny][nx] === player) count++;
                        else break;
                    }
                });
                if (count >= 5) return true;
            }
            return false;
        }

        function aiMove() {
            if(gameOver) return;
            let bestScore = -1, move = {x: 7, y: 7};
            for(let y=0; y<boardSize; y++) {
                for(let x=0; x<boardSize; x++) {
                    if(board[y][x] === 0) {
                        let score = evaluate(x, y);
                        if(score > bestScore) { bestScore = score; move = {x, y}; }
                    }
                }
            }
            placeStone(move.x, move.y, 2);
        }

        function evaluate(x, y) {
            let s = 0;
            [[1,0], [0,1], [1,1], [1,-1]].forEach(([dx, dy]) => {
                s += getScore(x, y, dx, dy, 2); // AI ê³µê²©
                s += getScore(x, y, dx, dy, 1) * 1.1; // ì‚¬ìš©ì ë°©ì–´
            });
            return s;
        }

        function getScore(x, y, dx, dy, p) {
            let c = 0, b = 0;
            [[dx, dy], [-dx, -dy]].forEach(([sx, sy]) => {
                for(let i=1; i<5; i++) {
                    let nx=x+sx*i, ny=y+sy*i;
                    if(nx>=0&&nx<boardSize&&ny>=0&&ny<boardSize) {
                        if(board[ny][nx]===p) c++; else if(board[ny][nx]!==0) { b++; break; } else break;
                    } else { b++; break; }
                }
            });
            if(c>=4) return 10000;
            if(c===3) return b===0 ? 5000 : 500;
            return c*10;
        }

        function placeStone(x, y, p) {
            board[y][x] = p;
            moveHistory.push({x, y, p});
            drawBoard();
            if(checkWin(x, y, p)) {
                gameOver = true;
                const winMsg = p === 1 ? "ì‚¬ìš©ì ìŠ¹ë¦¬!" : "AI ìŠ¹ë¦¬!";
                turnDisplay.innerText = winMsg;
                saveRecord(p === 1 ? "ìŠ¹ë¦¬" : "íŒ¨ë°°");
                setTimeout(() => alert(winMsg), 100);
            } else {
                turnDisplay.innerText = p === 1 ? "AIê°€ ìƒê° ì¤‘..." : "ì°¨ë¡€: í‘ëŒ â—";
                if(p === 1) setTimeout(aiMove, 600);
            }
        }

        canvas.addEventListener('pointerdown', (e) => {
            if(gameOver || turnDisplay.innerText.includes("AI")) return;
            const rect = canvas.getBoundingClientRect();
            const x = Math.round((e.clientX - rect.left - cellSize/2) / cellSize);
            const y = Math.round((e.clientY - rect.top - cellSize/2) / cellSize);

            if (x >= 0 && x < boardSize && y >= 0 && y < boardSize && board[y][x] === 0) {
                if(isDoubleThree(x, y, 1)) {
                    msgOverlay.innerText = "âš ï¸ 3x3 ê¸ˆìˆ˜ ìœ„ì¹˜ì…ë‹ˆë‹¤!";
                    setTimeout(() => msgOverlay.innerText = "", 2000);
                    return;
                }
                placeStone(x, y, 1);
            }
        });

        function undo() {
            if(gameOver || moveHistory.length < 2) return;
            const m1 = moveHistory.pop(); board[m1.y][m1.x] = 0;
            const m2 = moveHistory.pop(); board[m2.y][m2.x] = 0;
            drawBoard();
            turnDisplay.innerText = "ì°¨ë¡€: í‘ëŒ â—";
        }

        function saveRecord(result) {
            let history = JSON.parse(localStorage.getItem('omokHistory')) || [];
            const now = new Date();
            history.unshift({ result, date: `${now.getMonth()+1}/${now.getDate()}` });
            localStorage.setItem('omokHistory', JSON.stringify(history.slice(0, 10)));
            // ë¦¬í¬íŠ¸ ì ìˆ˜ ë°˜ì˜ (ìŠ¹ë¦¬ ì‹œ ë…¼ë¦¬ë ¥ ì ìˆ˜ ìƒìŠ¹)
            if(result === "ìŠ¹ë¦¬") localStorage.setItem('game2_score', 95);
            displayHistory();
        }

        function displayHistory() {
            const body = document.getElementById('historyBody');
            const history = JSON.parse(localStorage.getItem('omokHistory')) || [];
            body.innerHTML = history.length ? history.map((h, i) => `<tr><td>${history.length-i}íšŒ</td><td>${h.result}</td><td>${h.date}</td></tr>`).join('') : '<tr><td colspan="3">ê¸°ë¡ì´ ì—†ìŠµë‹ˆë‹¤.</td></tr>';
        }

        function resetGame() { location.reload(); }

        window.addEventListener('resize', initCanvas);
        initCanvas();
        displayHistory();
    </script>
</body>
</html>
